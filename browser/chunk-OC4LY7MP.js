import{a as M}from"./chunk-I53ZPROP.js";import{a as R,b as c,c as N,d as T,f as k,g as A,i as P,m as q,o as B}from"./chunk-2I67LZUT.js";import{c as I,e as E,f as L}from"./chunk-BAG2IDU5.js";import"./chunk-YFPKJNUV.js";import{$ as b,$a as g,Ca as p,Ha as S,Kb as w,Ma as d,Mb as C,Ob as F,Ta as m,Wa as n,Xa as i,Ya as u,_a as y,eb as a,gb as _,nb as h,ya as l}from"./chunk-GXRW5RWN.js";var D=e=>({"border-red-500":e});function V(e,r){e&1&&(n(0,"span"),a(1,"Email is required"),i())}function j(e,r){e&1&&(n(0,"span"),a(1,"Please enter a valid email address"),i())}function O(e,r){if(e&1&&(n(0,"div",23),d(1,V,2,0,"span",18)(2,j,2,0,"span",18),i()),e&2){let o,t,s=g();l(),m("ngIf",(o=s.loginForm.get("email"))==null||o.errors==null?null:o.errors.required),l(),m("ngIf",(t=s.loginForm.get("email"))==null||t.errors==null?null:t.errors.email)}}function z(e,r){e&1&&(n(0,"span"),a(1,"Password is required"),i())}function H(e,r){e&1&&(n(0,"span"),a(1,"Password must be at least 8 characters long"),i())}function Y(e,r){if(e&1&&(n(0,"div",23),d(1,z,2,0,"span",18)(2,H,2,0,"span",18),i()),e&2){let o,t,s=g();l(),m("ngIf",(o=s.loginForm.get("password"))==null||o.errors==null?null:o.errors.required),l(),m("ngIf",(t=s.loginForm.get("password"))==null||t.errors==null?null:t.errors.minlength)}}function J(e,r){if(e&1&&(n(0,"div",24),a(1),i()),e&2){let o=g();l(),_(" ",o.successMessage," ")}}function K(e,r){if(e&1&&(n(0,"div",25),a(1),i()),e&2){let o=g();l(),_(" ",o.errorMessage," ")}}function Q(e,r){e&1&&(n(0,"span"),b(),n(1,"svg",26),u(2,"circle",27)(3,"path",28),i(),a(4," Logging in... "),i())}function U(e,r){e&1&&(n(0,"span"),a(1,"Log In"),i())}var G=class e{constructor(r,o,t,s){this.formBuilder=r;this.router=o;this.route=t;this.authService=s}loginForm;isSubmitting=!1;errorMessage="";successMessage="";ngOnInit(){this.initForm(),this.checkRegistrationStatus()}checkRegistrationStatus(){this.route.queryParams.subscribe(r=>{r.registered==="true"&&(this.successMessage="Registration successful! Please log in with your credentials."),r.expired==="true"&&(this.errorMessage="Your session has expired. Please log in again.")})}initForm(){this.loginForm=this.formBuilder.group({email:["",[c.required,c.email]],password:["",[c.required,c.minLength(8)]]})}onSubmit(){this.loginForm.invalid||(this.isSubmitting=!0,this.errorMessage="",this.authService.login(this.loginForm.value).subscribe({next:r=>{r.roles.includes("ROLE_ADMIN")?this.router.navigate(["/admin"]):r.roles.includes("ROLE_APPLICANT")?this.router.navigate(["/applicant"]):this.router.navigate(["/"])},error:r=>{this.errorMessage=r.message||"Login failed. Please try again.",this.isSubmitting=!1},complete:()=>{this.isSubmitting=!1}}))}static \u0275fac=function(o){return new(o||e)(p(q),p(E),p(I),p(M))};static \u0275cmp=S({type:e,selectors:[["app-login"]],decls:34,vars:14,consts:[[1,"flex","pl-10"],[1,"flex-1","flex","rounded-lg","flex-col","justify-center","border","px-4","sm:px-6","bg-gradient-to-r","from-[#2dd4bf]","to-[#1f2937]"],[1,"mx-auto","m","w-full","max-w-sm","lg:w-96"],[1,"mb-8"],[1,"text-2xl","font-semibold","text-gray-900","mb-2"],[1,"text-sm","text-gray-600"],[1,"backdrop-blur-3xl","p-10","py-8","rounded-lg"],[1,"flex","flex-col","gap-5",3,"ngSubmit","formGroup"],[1,"self-center","font-medium","font-heading","text-white","text-xl"],[1,"space-y-2"],["for","email",1,"block","text-sm","font-medium","text-gray-100"],["type","email","id","email","formControlName","email","placeholder","your.email@example.com",1,"w-full","px-3","py-2","border","border-white","rounded-md","bg-transparent","text-white","placeholder:text-neutral-100","focus:outline-none","focus:ring-2","focus:ring-green-100",3,"ngClass"],["class","text-red-500 text-sm",4,"ngIf"],["for","password",1,"block","text-sm","font-medium","text-gray-100"],["type","password","id","password","formControlName","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"w-full","px-3","py-2","border","border-white","rounded-md","bg-transparent","text-white","placeholder:text-neutral-100","focus:outline-none","focus:ring-2","focus:ring-green-100",3,"ngClass"],["class","text-green-500 text-sm text-center p-2 bg-green-50 rounded-md mb-2",4,"ngIf"],["class","text-red-500 text-sm text-center p-2 bg-red-50 rounded-md mb-2",4,"ngIf"],["type","submit",1,"w-full","py-2","px-4","bg-primary-600","hover:bg-primary-700","text-white","font-medium","rounded-md","transition-colors",3,"disabled"],[4,"ngIf"],[1,"text-neutral-100","text-sm","self-center"],["routerLink","/auth/register",1,"hover:underline","text-primary-200"],[1,"mt-8","text-center"],[1,"lg:block","relative","w-full","flex-1","bg-primary-400","hidden","lg:flex"],[1,"text-red-500","text-sm"],[1,"text-green-500","text-sm","text-center","p-2","bg-green-50","rounded-md","mb-2"],[1,"text-red-500","text-sm","text-center","p-2","bg-red-50","rounded-md","mb-2"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-2","h-4","w-4","text-white","inline-block"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(o,t){if(o&1&&(n(0,"div",0)(1,"div",1)(2,"div",2),u(3,"div",3),n(4,"div",3)(5,"h2",4),a(6,"Connexion"),i(),n(7,"p",5),a(8,"Bon retour parmi nous, Veuillez vous connecter pour continuer !"),i()(),n(9,"div",6)(10,"form",7),y("ngSubmit",function(){return t.onSubmit()}),n(11,"div",8),a(12,"Login"),i(),n(13,"div",9)(14,"label",10),a(15,"Email"),i(),u(16,"input",11),d(17,O,3,2,"div",12),i(),n(18,"div",9)(19,"label",13),a(20,"Password"),i(),u(21,"input",14),d(22,Y,3,2,"div",12),i(),d(23,J,2,1,"div",15)(24,K,2,1,"div",16),n(25,"button",17),d(26,Q,5,0,"span",18)(27,U,2,0,"span",18),i(),n(28,"div",19),a(29," Don't have an account? "),n(30,"a",20),a(31,"Register"),i()()()()(),u(32,"div",21),i(),u(33,"div",22),i()),o&2){let s,f,v,x;l(10),m("formGroup",t.loginForm),l(6),m("ngClass",h(10,D,((s=t.loginForm.get("email"))==null?null:s.invalid)&&((s=t.loginForm.get("email"))==null?null:s.touched))),l(),m("ngIf",((f=t.loginForm.get("email"))==null?null:f.invalid)&&((f=t.loginForm.get("email"))==null?null:f.touched)),l(4),m("ngClass",h(12,D,((v=t.loginForm.get("password"))==null?null:v.invalid)&&((v=t.loginForm.get("password"))==null?null:v.touched))),l(),m("ngIf",((x=t.loginForm.get("password"))==null?null:x.invalid)&&((x=t.loginForm.get("password"))==null?null:x.touched)),l(),m("ngIf",t.successMessage),l(),m("ngIf",t.errorMessage),l(),m("disabled",t.loginForm.invalid||t.isSubmitting),l(),m("ngIf",t.isSubmitting),l(),m("ngIf",!t.isSubmitting)}},dependencies:[F,w,C,B,k,R,N,T,A,P,L],encapsulation:2})};export{G as LoginComponent};
